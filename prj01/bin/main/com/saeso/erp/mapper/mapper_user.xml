<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.saeso.erp.dao.UserDAO">



<insert id="insertBoard" parameterType="com.saeso.erp.dto.UserDTO" >
		insert into member( 
			member_no
			,member_email
			,member_pw
			,member_name
			,nick
			,phone
			,jumin_num
			,reg_date
			,delivery_name
			,zipcode
			,addr1
			,addr2 		
		) values (
			(select nvl(max(member_no),0)+1 from board)
			,#{member_email} <!-- BoardDTO 객체의 subject 속성변수 안의 값 삽입하기. 문자면 ' 를 앞뒤에 붙여준다.-->
			,#{member_pw}  <!-- BoardDTO 객체의 writer 속성변수 안의 값 삽입하기. 문자면 ' 를 앞뒤에 붙여준다.-->
			,#{member_name}
			,#{nick} <!-- BoardDTO 객체의 content 속성변수 안의 값 삽입하기. 문자면 ' 를 앞뒤에 붙여준다.-->
			,#{phone}     <!-- BoardDTO 객체의 pwd 속성변수 안의 값 삽입하기. 문자면 ' 를 앞뒤에 붙여준다.-->
			,#{jumin_num}   <!-- BoardDTO 객체의 email 속성변수 안의 값 삽입하기. 문자면 ' 를 앞뒤에 붙여준다.-->
			,#{reg_date}
			,#{delivery_name}
			,#{zipcode}
			,#{addr1}
			,#{addr2}
		)
	</insert>
	
	
	<select id="getInfo" parameterType="int" resultType="com.saeso.erp.dto.UserDTO">
		select 
			member_no 		 "member_no"
			,member_email 	 "member_email"
			,member_pw 	 	 "member_pw"
			,member_name     "member_name" 
			,nick   		 "nick"
			,phone 			 "phone"
			,jumin_num 		 "jumin_num"
			,reg_date 		 "reg_date"
			,delivery_name	 "delivery_name"
			,zipcode	  	 "zipcode"
			,addr1  		 "addr1"
			,addr2  		 "addr2"
		from 
			member
		where
			member_no=#{member_no}
	</select>
	
	<select id="getInfoCnt" parameterType="com.saeso.erp.dto.UserDTO" resultType="int">
		select count(*) from member where member_no=#{member_no}
	</select>
	
	
	<select id="getUser_pwd_Cnt" parameterType="com.saeso.erp.dto.UserDTO" resultType="int">
		select count(*) from member where member_no=#{member_no} and member_pw=#{member_pw}
	</select>
	
	
	<update id="updateInfo" parameterType="com.saeso.erp.dto.UserDTO">
		update
			member
		set
			member_name  = #{member_name}
			,jumin_num 	 = #{jumin_num}
			,nick 	 	 = #{nick}
			,member_email= #{member_email}
			,phone 		 = #{phone}
			,zipcode	 = #{zipcode}
			,addr1	 	 = #{addr1}
			,addr2 	 	 = #{addr2}
		where
			member_no=#{member_no}
	</update>
	
	
	<update id="updatePw" parameterType="com.saeso.erp.dto.UserDTO">
		update
			member
		set
			member_pw = #{member_pw}
		where
			member_no=#{member_no}
	</update>
	
	
	
	<delete id="deleteInfo" parameterType="com.saeso.erp.dto.UserDTO">
		delete from member where member_no=#{member_no} and member_pw=#{member_pw}
	</delete>
	
	
	
	
	<!-- 후기 등록하기 -->
	<update id="updateRevReg" parameterType="com.saeso.erp.dto.ExpApplDTO">
		update 
			EXP_APPLy
		set		
			 select_flag = 1		
			, review_url = #{rev_url}			
			, satisfaction_level = #{satis_lv}			
			, rebuy_flag = #{rebuy_fl}		 	
			, review_reg_date = sysdate
			where
				exp_no = #{exp_no}			
				and
				member_no = #{user_no}
	</update>
	
	

	
</mapper>